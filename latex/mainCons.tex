%!TEX root = main.tex

\section{Main construction}

We present our main construction, which is a semi-honest secure protocol for the functionality in \figureref{fig:ssotfunc}, instantiated with the our \SSOT. We also show a simple case of the semi-honest secure protocol for multi-party PSI when the number of the parties is three. Next, we will describe our multi-party PSI protocol in general case. 
%\cite{C:IKNP03,C:KolKum13,CCS:ALSZ13}
 

\subsection{Notation}

\subsection{The \SSOT construction}
\label{sect:ssot-construction}


Our \SSOT protocol is presented in Figure~\ref{fig:ssot}. It closely follows the high-level overview. 


\begin{figure}[h]\centering
\iffalse
\framebox{
    \begin{minipage}{0.95\linewidth}
        \noindent{
\\
{\sc Input of \RR:} \numinst\ selection strings $\br = (r_1,\ldots, r_\numinst)$, $r_i\in\{0,1\}^*$.

\medskip

{\sc Parameters:}
\begin{itemize}\addtolength{\itemsep}{-6pt}
\item  A $(\kappa,\epsilon)$-PRC family $\mathcal{C}$ with output length $k = k(\kappa)$. % We elaborate later on the specific choice of these parameters.
\item A $\kappa$-Hamming correlation-robust  $H:[\numinst]\times\bool^\csp \to \bool^v$.
\item An ideal \otkm\ primitive. 
\end{itemize}
}

{\sc Protocol:}

\begin{enumerate}
\addtocounter{enumi}{-1}
\item \SS\ chooses a random $C \gets \mathcal C$ and sends it to \RR.
\item \SS\ chooses $\sec \from\bool^\csp$ at random. Let $\seci$ denote the $i$-th bit of \sec.
\item \RR\ forms $\numinst \times \csp$ matrices $\Tz,\To$ in the following way:
\begin{itemize}
\item For $j \in [\numinst]$, choose $\tjz \from \bool^\csp$ and set $\tjo = \delrj \oplus \tjz$.
%$\delrj$.
\end{itemize}
Let $\tiz, \tio$ denote the $i$-th column of matrices \Tz, \To\ respectively.
\item \SS\ and \RR\ interact with \otkm\ in the following way:
\begin{itemize}
\item \SS\ acts as {\em receiver} with input \setsub{\seci}{i\in[\csp]}.
\item \RR\ acts as {\em sender} with input \setsub{\tiz,\tio}{i\in[\csp]}.
\item \SS\ receives output \setsub{\qi}{i\in[\csp]}.
\end{itemize}
\SS\ forms $\numinst \times \csp$ matrix \Q\ such that the $i$-th column of \Q\ is the vector \qi. (Note $\qi = \bt^i_\seci$.) Let \qj\ denote the $j$-th row of \Q. Note, $\qj = (\bwand{(\tjz\xor\tjo)}{\sec}) \xor \tjz$. Simplifying, $\qj = \tjz \xor (\bwand{\delrj}{\sec})$.


\item     For $j \in [\numinst]$, \SS\ outputs the PRF seed $((C,\sec), (j, \qj))$.


\item For $j\in[\numinst]$, \RR\ outputs relaxed PRF output $(C, j, \tjz)$.
\end{enumerate}


    \end{minipage}
}
\fi
\caption{The \SSOT protocol}
\label{fig:ssot}
\end{figure}




\begin{theorem}
\label{thm:sot}
The \SSOT protocol in \figureref{fig:ssot} securely realizes the  functionality of \figureref{fig:ssotfunc}, instantiated with the SSOT defined in \lemmaref{lem:prf-construction}, in the presence of semi-honest adversaries, where $\kappa$ is the computational security parameter.
\end{theorem}


\begin{proof}
%
When using the abstraction of our SSOT functionality, the proof is elementary.

In both cases it is straightforward to check that the simulation is perfect.
\end{proof}

 